<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>&colon;rocket&colon; Sobre o desafio</title>
        <style>
</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        
        
    </head>
    <body class="vscode-body vscode-light">
        <img alt="GoStack" src="file:////Users/brunogarcia/www/bootcamp2021/reactjs02/primeiro-projeto-react/assets/github-explorer.gif" />
<h3 align="center">
  Desafio 06: Banco de dados e upload de arquivos no Node.js
</h3>
<blockquote align="center">‚ÄúS√≥ deseje as coisas as quais voc√™ est√° disposto a lutar‚Äù!</blockquote>
<h2 id="rocket-sobre-o-desafio">:rocket: Sobre o desafio</h2>
<p>A aplica√ß√£o armazena transa√ß√µes financeiras de entrada e sa√≠da e permite o cadastro e a listagem dessas transa√ß√µes, al√©m de permitir a cria√ß√£o de novos registros no banco de dados a partir do envio de um arquivo csv.</p>
<h3 id="rotas-da-aplica√ß√£o">Rotas da aplica√ß√£o</h3>
<ul>
<li><strong><code>POST /transactions</code></strong>: A rota recebe <code>title</code>, <code>value</code>, <code>type</code>, e <code>category</code> dentro do corpo da requisi√ß√£o, sendo o <code>type</code> o tipo da transa√ß√£o, que √© <code>income</code> para entradas (dep√≥sitos) e <code>outcome</code> para sa√≠das (retiradas). Ao cadastrar uma nova transa√ß√£o, a mesma √© armazenada dentro do seu banco de dados, possuindo os campos <code>id</code>, <code>title</code>, <code>value</code>, <code>type</code>, <code>category_id</code>, <code>created_at</code>, <code>updated_at</code>.</li>
</ul>
<p><strong>Obs 1</strong>: A categoria √© armazenada em uma tabela especifica, e tem os campos <code>id</code>, <code>title</code>, <code>created_at</code>, <code>updated_at</code>.</p>
<p><strong>Obs 2</strong>: Antes de criar uma nova categoria, √© verificado se j√° existe uma categoria com o mesmo t√≠tulo. Caso ela exista, √© usado o <code>id</code> j√° existente no banco de dados.</p>
<pre><code class="language-json"><div>{
  <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
  <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Sal√°rio&quot;</span>,
  <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">3000</span>,
  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;income&quot;</span>,
  <span class="hljs-attr">&quot;category&quot;</span>: <span class="hljs-string">&quot;Alimenta√ß√£o&quot;</span>
}
</div></code></pre>
<ul>
<li><strong><code>GET /transactions</code></strong>: Essa rota retorna uma listagem com todas as transa√ß√µes cadastradas, junto com o valor da soma de entradas, retiradas e total de cr√©dito. Essa rota retorna um objeto do seguinte formato:</li>
</ul>
<pre><code class="language-json"><div>{
  <span class="hljs-attr">&quot;transactions&quot;</span>: [
    {
      <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Sal√°rio&quot;</span>,
      <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">4000</span>,
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;income&quot;</span>,
      <span class="hljs-attr">&quot;category&quot;</span>: {
        <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Salary&quot;</span>,
        <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
        <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
      },
      <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
      <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
    },
    {
      <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Freela&quot;</span>,
      <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">2000</span>,
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;income&quot;</span>,
      <span class="hljs-attr">&quot;category&quot;</span>: {
        <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Others&quot;</span>,
        <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
        <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
      },
      <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
      <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
    },
    {
      <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Pagamento da fatura&quot;</span>,
      <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">4000</span>,
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;outcome&quot;</span>,
      <span class="hljs-attr">&quot;category&quot;</span>: {
        <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Others&quot;</span>,
        <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
        <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
      },
      <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
      <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
    },
    {
      <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Cadeira Gamer&quot;</span>,
      <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">1200</span>,
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;outcome&quot;</span>,
      <span class="hljs-attr">&quot;category&quot;</span>: {
        <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;uuid&quot;</span>,
        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;Recreation&quot;</span>,
        <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
        <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
      },
      <span class="hljs-attr">&quot;created_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>,
      <span class="hljs-attr">&quot;updated_at&quot;</span>: <span class="hljs-string">&quot;2020-04-20T00:00:49.620Z&quot;</span>
    }
  ],
  <span class="hljs-attr">&quot;balance&quot;</span>: {
    <span class="hljs-attr">&quot;income&quot;</span>: <span class="hljs-number">6000</span>,
    <span class="hljs-attr">&quot;outcome&quot;</span>: <span class="hljs-number">5200</span>,
    <span class="hljs-attr">&quot;total&quot;</span>: <span class="hljs-number">800</span>
  }
}
</div></code></pre>
<p><strong>Obs 3</strong>: Dentro de balance, o income √© a soma de todos os valores das transa√ß√µes com <code>type</code> income. O outcome √© a soma de todos os valores das transa√ß√µes com <code>type</code> outcome, e o total √© o valor de <code>income - outcome</code>.</p>
<p><strong>Obs 4</strong>: Para fazer a soma dos valores, foi utilizado a fun√ß√£o <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce">reduce</a> para agrupar as transa√ß√µes pela propriedade <code>type</code>, assim consegui somar todos os valores com facilidade e obter o retorno do <code>balance</code>.</p>
<ul>
<li><strong><code>DELETE /transactions/:id</code></strong>: A rota deleta uma transa√ß√£o com o <code>id</code> presente nos par√¢metros da rota;</li>
</ul>
<ul>
<li><strong><code>POST /transactions/import</code></strong>: A rota permiti a importa√ß√£o de um arquivo com formato <code>.csv</code> contendo as mesmas informa√ß√µes necess√°rias para cria√ß√£o de uma transa√ß√£o <code>id</code>, <code>title</code>, <code>value</code>, <code>type</code>, <code>category_id</code>, <code>created_at</code>, <code>updated_at</code>, onde cada linha do arquivo CSV √© um novo registro para o banco de dados, e por fim retorna todas as <code>transactions</code> que foram importadas para o banco de dados. O arquivo csv, cont√©m o seguinte <a href="./assets/file.csv">modelo</a></li>
</ul>
<h3 id="espec√≠fica√ß√£o-dos-testes">Espec√≠fica√ß√£o dos testes</h3>
<p>Em cada teste, tem uma breve descri√ß√£o no que sua aplica√ß√£o deve cumprir para que o teste passe.</p>
<p>Para esse desafio, temos os seguintes testes:</p>
<h4 align="center">
  ‚ö†Ô∏è Antes de rodar os testes, crie um banco de dados com o nome "gostack_desafio06_tests" para que todos os testes possam executar corretamente ‚ö†Ô∏è
</h4>
<ul>
<li><strong><code>should be able to create a new transaction</code></strong>: Para que esse teste passe, a aplica√ß√£o deve permitir que uma transa√ß√£o seja criada, e retorne um json com a transa√ß√£o criado.</li>
</ul>
<ul>
<li><strong><code>should create tags when inserting new transactions</code></strong>: Para que esse teste passe, a aplica√ß√£o deve permitir que ao criar uma nova transa√ß√£o com uma categoria que n√£o existe, essa seja criada e inserida no campo category_id da transa√ß√£o com o <code>id</code> que acabou de ser criado.</li>
</ul>
<ul>
<li><strong><code>should not create tags when they already exists</code></strong>: Para que esse teste passe, a aplica√ß√£o deve permitir que ao criar uma nova transa√ß√£o com uma categoria que j√° existe, seja atribu√≠do ao campo category_id da transa√ß√£o com o <code>id</code> dessa categoria existente, n√£o permitindo a cria√ß√£o de categorias com o mesmo <code>title</code>.</li>
</ul>
<ul>
<li><strong><code>should be able to list the transactions</code></strong>: Para que esse teste passe, a aplica√ß√£o deve permitir que seja retornado um array de objetos contendo todas as transa√ß√µes junto ao balan√ßo de income, outcome e total das transa√ß√µes que foram criadas at√© o momento.</li>
</ul>
<ul>
<li><strong><code>should not be able to create outcome transaction without a valid balance</code></strong>: Para que esse teste passe, a aplica√ß√£o n√£o deve permitir que uma transa√ß√£o do tipo <code>outcome</code> extrapole o valor total que o usu√°rio tem em caixa (total de income), retornando uma resposta com c√≥digo HTTP 400 e uma mensagem de erro no seguinte formato: <code>{ error: string }</code>.</li>
</ul>
<ul>
<li><strong><code>should be able to delete a transaction</code></strong>: Para que esse teste passe, voc√™ deve permitir que a sua rota de delete exclua uma transa√ß√£o, e ao fazer a exclus√£o, ele retorne uma resposta vazia, com status 204.</li>
</ul>
<ul>
<li><strong><code>should be able to import transactions</code></strong>: Para que esse teste passe, a aplica√ß√£o deve permitir que seja importado um arquivo csv, contendo o seguinte <a href="./assets/file.csv">modelo</a>. Com o arquivo importado, voc√™ deve permitir que seja criado no banco de dados todos os registros e categorias que estavam presentes nesse arquivo, e retornar todas as transactions que foram importadas.</li>
</ul>
<h2 id="memo-licen√ßa">:memo: Licen√ßa</h2>
<p>Esse projeto est√° sob a licen√ßa MIT. Veja o arquivo <a href="../LICENSE">LICENSE</a> para mais detalhes.</p>
<hr>
<p>Feito com üíú by Rocketseat :wave: <a href="https://discordapp.com/invite/gCRAFhc">Entre na nossa comunidade!</a></p>

    </body>
    </html>